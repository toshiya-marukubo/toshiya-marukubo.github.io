"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}var Mouse=function(){function a(b){_classCallCheck(this,a),this.sketch=b,this.initialize()}return _createClass(a,[{key:"initialize",value:function initialize(){this.delta=0,this.mouse=new THREE.Vector3,this.setupEvents()}},{key:"setupEvents",value:function setupEvents(){window.addEventListener("scroll",this.onScroll.bind(this),!1),window.addEventListener("mousemove",this.onMousemove.bind(this),!1),window.addEventListener("touchmove",this.onTouchmove.bind(this),!1)}},{key:"onScroll",value:function onScroll(){var a=window.pageYOffset,b=document.body.scrollHeight-window.innerHeight;this.delta=a/b}},{key:"onMousemove",value:function onMousemove(a){this.mouse.x=2*(a.clientX/window.innerWidth)-1,this.mouse.y=2*-(a.clientY/window.innerHeight)+1,this.mouse.z=0}},{key:"onTouchmove",value:function onTouchmove(a){var b=a.targetTouches[0];this.mouse.x=2*(b.pageX/window.innerWidth)-1,this.mouse.y=2*-(b.pageY/window.innerHeight)+1,this.mouse.z=0}}]),a}(),Sketch=function(){function a(){_classCallCheck(this,a),this.createCanvas(),this.setupEvents(),this.time=new THREE.Clock(!0),this.mouse=new Mouse(this),this.initialize()}return _createClass(a,[{key:"createCanvas",value:function createCanvas(){this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),document.body.appendChild(this.renderer.domElement)}},{key:"setupEvents",value:function setupEvents(){window.addEventListener("resize",this.onResize.bind(this),!1)}},{key:"onResize",value:function onResize(){this.preWidth===window.innerWidth&&480>window.innerWidth||this.initialize()}},{key:"initialize",value:function initialize(){this.animationId&&cancelAnimationFrame(this.animationId),this.preWidth=this.width=Math.ceil(window.innerWidth),this.height=Math.ceil(window.innerHeight),this.scene=new THREE.Scene,this.setupCanvas(),this.setupCamera(),this.setupLight(),this.setupShape(),this.draw()}},{key:"setupCanvas",value:function setupCanvas(){this.renderer.setSize(this.width,this.height),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor("#FBDD0A",1),this.renderer.domElement.style.position="fixed",this.renderer.domElement.style.top="0",this.renderer.domElement.style.left="0",this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.zIndex="-1",this.renderer.domElement.style.outline="none"}},{key:"setupCamera",value:function setupCamera(){var a=35*(Math.PI/180);this.dist=this.height/2/Math.tan(a),this.camera=new THREE.PerspectiveCamera(70,this.width/this.height,.01,10*this.dist),this.cameraV=new THREE.Vector3,this.cameraP=new THREE.Vector3(0,.005*this.dist,this.dist),this.camera.position.set(this.cameraP),this.camera.lookAt(new THREE.Vector3),this.scene.add(this.camera)}},{key:"updateCamera",value:function updateCamera(){this.cameraV.subVectors(this.mouse.mouse,this.cameraP).multiplyScalar(.05),this.cameraP.add(this.cameraV),this.camera.position.set(this.cameraP.x*this.dist,Math.max(this.cameraP.y*this.dist,10),this.dist),this.camera.lookAt(new THREE.Vector3)}},{key:"setupLight",value:function setupLight(){this.directionalLight=new THREE.DirectionalLight(16777215),this.scene.add(this.directionalLight),this.spotLight=new THREE.SpotLight(16777215),this.spotLightV=new THREE.Vector3,this.spotLightP=new THREE.Vector3(0,.005*this.dist,this.dist),this.spotLight.position.set(this.spotLightP),this.spotLight.lookAt(new THREE.Vector3),this.scene.add(this.spotLight)}},{key:"updateLight",value:function updateLight(){this.spotLightV.subVectors(this.mouse.mouse,this.spotLightP).multiplyScalar(.05),this.spotLightP.add(this.spotLightV),this.spotLight.position.set(this.spotLightP.x*this.dist,Math.max(this.spotLightP.y*this.dist,100),this.dist),this.spotLight.lookAt(new THREE.Vector3)}},{key:"setupShape",value:function setupShape(){this.setupSize(),this.shapes=[],this.num=4;for(var b=0,c=-this.num;c<this.num;c++)for(var g=-this.num;g<this.num;g++){var d=this.size*c+this.size/2,e=this.size*g+this.size/2,f=Math.atan2(e,d),a=new Shape(this,d,2*-this.size,e,this.size,this.shapeHeight,b++,f);this.shapes.push(a)}this.geometry=new THREE.BoxGeometry(this.groundSize,this.groundSize,this.groundSize),this.material=new THREE.MeshBasicMaterial({color:"#FBDD0A",side:THREE.DoubleSide}),this.box=new THREE.Mesh(this.geometry,this.material),this.box.position.set(0,-this.groundSize/2-2*this.size,0),this.scene.add(this.box)}},{key:"setupSize",value:function setupSize(){this.size=null,this.shapeHeight=null,this.groundSize=Math.max(5*this.width,5*this.height),768>=this.width&&(this.size=25,this.shapeHeight=50),768<=this.width&&(this.size=40,this.shapeHeight=80)}},{key:"draw",value:function draw(){for(var a=this.time.getElapsedTime(),b=0;b<this.shapes.length;b++)this.shapes[b].render(a);this.updateCamera(a),this.updateLight(a),this.renderer.render(this.scene,this.camera),this.animationId=requestAnimationFrame(this.draw.bind(this))}}]),a}(),Shape=function(){function b(c,d,e,f,g,h,i,j){_classCallCheck(this,b),this.sketch=c,this.position=new THREE.Vector3(d,e,f),this.size=g/2,this.index=i,this.a=.5*j,this.height=h,this.dist=this.position.distanceTo(new THREE.Vector3),this.initialize()}return _createClass(b,[{key:"initialize",value:function initialize(){this.cylinderGeometry=new THREE.CylinderGeometry(this.size,this.size,this.height,36,1,!1,0,2*Math.PI),this.cylinderMaterial=new THREE.MeshPhongMaterial(this.getMaterial(this.index)),this.cylindereMesh=new THREE.Mesh(this.cylinderGeometry,this.cylinderMaterial),this.cylindereMesh.position.set(this.position.x,this.position.y,this.position.z),this.sketch.scene.add(this.cylindereMesh),this.sphereGeometry=new THREE.SphereGeometry(.9*this.size,32,32),this.sphereMaterial=new THREE.MeshPhongMaterial(this.getMaterial(this.index)),this.sphereMesh=new THREE.Mesh(this.sphereGeometry,this.sphereMaterial),this.sphereMesh.position.set(this.position.x,this.position.y+this.height/2,this.position.z),this.sketch.scene.add(this.sphereMesh)}},{key:"getMaterial",value:function getMaterial(a){var b,c=Math.floor(a%3);return 0===c&&(b={side:THREE.DoubleSide,color:"#AAFF00",emissive:0,specular:16777215,shininess:8}),1===c&&(b={side:THREE.DoubleSide,color:"#FFAA00",emissive:0,specular:16777215,shininess:8}),2===c&&(b={side:THREE.DoubleSide,color:"#FF00A9",emissive:0,specular:16777215,shininess:8}),b}},{key:"updateParameters",value:function updateParameters(a){this.cylindereMesh.scale.y=2*Math.abs(Math.sin(.005*this.dist-this.a-a))+1.5,this.sphereMesh.position.y=2.5*(Math.abs(Math.sin(.005*this.dist-this.a-a))*this.height)}},{key:"render",value:function render(a){this.updateParameters(a)}}]),b}();(function(){window.addEventListener("load",function(){new Loading("loading","loaded"),new FullScreen,new Sketch})})();