"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}var CellAutomaton=function(){function a(b,c,d){_classCallCheck(this,a),this.ctx=b,this.width=c,this.height=d,this.state=this.createMultipleArray(this.height,this.width),this.lastState=this.createMultipleArray(this.height,this.width),this.d=this.ctx.createImageData(this.width,this.height),this.setupData()}return _createClass(a,[{key:"createMultipleArray",value:function createMultipleArray(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}},{key:"setupData",value:function setupData(){for(var a=0;a<this.height;a++)for(var b=0;b<this.width;b++)this.state[a][b]=Math.floor(256*Math.random())}},{key:"drawData",value:function drawData(){this.ctx.putImageData(this.d,0,0)}},{key:"updateData",value:function updateData(){for(var a=0;a<this.height;a++)for(var b,c=0;c<this.width;c++)b=a*this.width+c,this.d.data[4*b+0]=255,this.d.data[4*b+1]=255,this.d.data[4*b+2]=255,this.d.data[4*b+3]=this.state[a][c]}},{key:"updateState",value:function updateState(){for(var a=this.createMultipleArray(this.height,this.width),c=0;c<this.height;c++)for(var r=0;r<this.width;r++){var d=0,e=c-1,f=c+1,g=r-1,h=r+1;0>e&&(e=this.height-1),f==this.height&&(f=0),0>g&&(g=this.width-1),h==this.width&&(h=0);var i=this.state[e][r],j=this.state[c][h],k=this.state[f][r],b=this.state[c][g],l=this.state[e][g],m=this.state[f][g],n=this.state[f][h],o=this.state[e][h];d=i+j+k+b+l+m+n+o;var p=Math.floor(d/8),q=void 0;255==p?q=0:0==p?q=255:(q=this.state[c][r]+p,0<this.lastState[c][r]&&(q-=this.lastState[c][r]),255<q?q=255:0>q&&(q=0)),a[c][r]=q}this.lastState=this.state,this.state=a}},{key:"render",value:function render(){this.ctx.clearRect(0,0,this.width,this.height),this.updateData(),this.updateState(),this.drawData()}}]),a}();